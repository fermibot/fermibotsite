<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vertical Recipe Timeline - Biryani Preparation</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f8f8f8;
      color: #333;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background-color: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h1 {
      color: #d35400;
      text-align: center;
      margin-bottom: 30px;
      border-bottom: 2px solid #f39c12;
      padding-bottom: 10px;
    }
    .description {
      text-align: center;
      margin-bottom: 20px;
      color: #666;
    }
    #timeline {
      width: 100%;
      height: 700px;
      margin-bottom: 20px;
      position: relative;
    }
    .legend {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 20px;
    }
    .legend-item {
      display: flex;
      align-items: center;
      margin: 5px 15px;
    }
    .legend-color {
      width: 20px;
      height: 20px;
      margin-right: 8px;
      border-radius: 4px;
    }
    .instructions {
      margin-top: 30px;
      padding: 15px;
      background-color: #f9f9f9;
      border-radius: 5px;
      border-left: 4px solid #f39c12;
    }
    .instructions h3 {
      margin-top: 0;
      color: #d35400;
    }
    .recipe-info {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    .recipe-section {
      flex: 1;
      min-width: 200px;
      margin: 10px;
      padding: 15px;
      background-color: #f9f9f9;
      border-radius: 5px;
    }
    .recipe-section h3 {
      color: #d35400;
      border-bottom: 1px solid #eee;
      padding-bottom: 5px;
    }
    ul {
      padding-left: 20px;
    }
    li {
      margin-bottom: 5px;
    }
    .timeline-event {
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .timeline-event:hover {
      transform: scale(1.05);
    }
    .timeline-label {
      font-size: 12px;
      font-weight: 500;
      fill: #333;
    }
    .timeline-category-label {
      font-size: 14px;
      font-weight: 600;
      fill: #d35400;
    }
    .tooltip {
      position: absolute;
      padding: 10px;
      background: rgba(255, 255, 255, 0.95);
      border: 1px solid #ddd;
      border-radius: 4px;
      pointer-events: none;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      z-index: 10;
      max-width: 300px;
    }
    @media (max-width: 768px) {
      .recipe-info {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
<div class="container">
  <h1>Vertical Biryani Recipe Timeline</h1>

  <div class="description">
    <p>This vertical timeline visualizes the step-by-step process of making biryani, showing when each step occurs and how long it takes.</p>
  </div>

  <div class="recipe-info">
    <div class="recipe-section">
      <h3>For Rice</h3>
      <ul>
        <li>Water as required</li>
        <li>Salt to taste</li>
        <li>1 tsp Ghee</li>
        <li>½ inch Cinnamon stick</li>
        <li>1 Bay leaf</li>
        <li>3 cups Sella basmati rice (soaked for 20 minutes)</li>
      </ul>
    </div>

    <div class="recipe-section">
      <h3>For Jhol</h3>
      <ul>
        <li>⅓ cup Milk</li>
        <li>1 ½ tsp Saffron water</li>
        <li>¼ tsp Green cardamom & mace powder</li>
        <li>A pinch of shahi jeera (optional)</li>
        <li>1 Green chilli, less spicy & slit</li>
        <li>Few Mint leaves, roughly torn</li>
        <li>2 tbsp Coriander leaves, roughly torn</li>
        <li>Salt to taste</li>
        <li>½ tsp Sugar</li>
      </ul>
    </div>

    <div class="recipe-section">
      <h3>For Layering</h3>
      <ul>
        <li>Marinated Chicken</li>
        <li>1st batch of Cooked Rice</li>
        <li>Prepared Jhol</li>
        <li>Saffron water</li>
        <li>Fried Onions</li>
        <li>2nd batch of Cooked rice</li>
        <li>1 tsp Ghee</li>
      </ul>
    </div>
  </div>

  <div id="timeline"></div>

  <div class="legend" id="legend"></div>

  <div class="instructions">
    <h3>How to Read the Timeline</h3>
    <p>The vertical line represents time from 0 to 80 minutes. Each colored circle represents a cooking task, positioned at the time it starts. The horizontal position shows the category of the task. Hover over any circle to see details about that step.</p>
  </div>
</div>

<script>
  // Create timeline data based on the recipe
  function createRecipeTimelineData() {
    // Define the recipe steps with start and end times (in minutes)
    const steps = [
      // Preparation group
      { group: "Preparation", label: "Fry Onions", start: 0, end: 10, category: "prep" },
      { group: "Preparation", label: "Marinate Chicken", start: 10, end: 15, category: "prep" },

      // Rice Cooking group
      { group: "Rice Cooking", label: "Cook Rice (Batch 1 & 2)", start: 15, end: 20, category: "rice" },
      { group: "Rice Cooking", label: "Rest Rice (Both Batches)", start: 20, end: 40, category: "rest" },

      // Jhol Preparation group
      { group: "Jhol Preparation", label: "Prepare Saffron Jhol", start: 25, end: 30, category: "jhol" },

      // Layering group
      { group: "Layering", label: "Layer Ingredients", start: 40, end: 45, category: "layer" },

      // Cooking group
      { group: "Cooking", label: "Dum Cooking (High Flame)", start: 45, end: 47, category: "cook" },
      { group: "Cooking", label: "Dum Cooking (Low Flame)", start: 47, end: 67, category: "cook" },

      // Final group
      { group: "Final", label: "Rest Dish", start: 67, end: 79, category: "rest" },
      { group: "Final", label: "Garnish and Serve", start: 79, end: 80, category: "final" }
    ];

    return steps;
  }

  // Create the vertical timeline chart
  function createVerticalTimeline() {
    const data = createRecipeTimelineData();
    const container = document.getElementById('timeline');
    const margin = { top: 30, right: 100, bottom: 30, left: 150 };
    const width = container.clientWidth - margin.left - margin.right;
    const height = container.clientHeight - margin.top - margin.bottom;

    // Clear any existing SVG
    d3.select("#timeline").selectAll("*").remove();

    // Create SVG
    const svg = d3.select("#timeline")
            .append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

    // Define color scale
    const colorScale = d3.scaleOrdinal()
            .domain(["prep", "rice", "rest", "jhol", "layer", "cook", "final"])
            .range(["#e74c3c", "#3498db", "#2ecc71", "#9b59b6", "#f1c40f", "#e67e22", "#1abc9c"]);

    // Define scales
    const yScale = d3.scaleLinear()
            .domain([0, 80]) // Total time in minutes
            .range([0, height]);

    // Define category positions (horizontal offsets)
    const categories = ["Preparation", "Rice Cooking", "Jhol Preparation", "Layering", "Cooking", "Final"];
    const categoryScale = d3.scalePoint()
            .domain(categories)
            .range([0, width])
            .padding(0.5);

    // Draw the main timeline (vertical line)
    svg.append("line")
            .attr("x1", width / 2)
            .attr("y1", 0)
            .attr("x2", width / 2)
            .attr("y2", height)
            .attr("stroke", "#ddd")
            .attr("stroke-width", 2);

    // Add time markers and labels
    const timeMarkers = [0, 10, 20, 30, 40, 50, 60, 70, 80];
    svg.selectAll(".time-marker")
            .data(timeMarkers)
            .enter()
            .append("line")
            .attr("class", "time-marker")
            .attr("x1", width / 2 - 10)
            .attr("x2", width / 2 + 10)
            .attr("y1", d => yScale(d))
            .attr("y2", d => yScale(d))
            .attr("stroke", "#999")
            .attr("stroke-width", 1);

    svg.selectAll(".time-label")
            .data(timeMarkers)
            .enter()
            .append("text")
            .attr("class", "time-label")
            .attr("x", width / 2 - 20)
            .attr("y", d => yScale(d))
            .attr("text-anchor", "end")
            .attr("alignment-baseline", "middle")
            .attr("font-size", "12px")
            .attr("fill", "#666")
            .text(d => `${d} min`);

    // Draw category labels
    svg.selectAll(".category-label")
            .data(categories)
            .enter()
            .append("text")
            .attr("class", "timeline-category-label")
            .attr("x", d => categoryScale(d))
            .attr("y", -10)
            .attr("text-anchor", "middle")
            .text(d => d);

    // Draw events (circles) for each step
    const events = svg.selectAll(".timeline-event")
            .data(data)
            .enter()
            .append("g")
            .attr("class", "timeline-event")
            .attr("transform", d => `translate(${categoryScale(d.group)}, ${yScale(d.start)})`);

    // Draw circles for each event
    events.append("circle")
            .attr("r", 8)
            .attr("fill", d => colorScale(d.category))
            .attr("stroke", "#fff")
            .attr("stroke-width", 2)
            .on("mouseover", function(event, d) {
              // Highlight the circle
              d3.select(this).attr("r", 10);

              // Draw a line to the timeline
              svg.append("line")
                      .attr("class", "event-connector")
                      .attr("x1", categoryScale(d.group))
                      .attr("y1", yScale(d.start))
                      .attr("x2", width / 2)
                      .attr("y2", yScale(d.start))
                      .attr("stroke", colorScale(d.category))
                      .attr("stroke-width", 1)
                      .attr("stroke-dasharray", "3,3");

              // Show tooltip
              const tooltip = d3.select("body")
                      .append("div")
                      .attr("class", "tooltip")
                      .style("position", "absolute")
                      .style("background", "#fff")
                      .style("border", "1px solid #ccc")
                      .style("border-radius", "4px")
                      .style("padding", "8px")
                      .style("box-shadow", "0 2px 4px rgba(0,0,0,0.2)")
                      .style("opacity", 0);

              tooltip.transition()
                      .duration(200)
                      .style("opacity", 0.9);

              tooltip.html(`
          <strong>${d.label}</strong><br>
          <span style="color: ${colorScale(d.category)}">${d.group}</span><br>
          Duration: ${d.end - d.start} minutes<br>
          Start: ${d.start} minutes<br>
          End: ${d.end} minutes
        `)
                      .style("left", (event.pageX + 10) + "px")
                      .style("top", (event.pageY - 28) + "px");
            })
            .on("mouseout", function(event, d) {
              // Reset circle size
              d3.select(this).attr("r", 8);

              // Remove connector line
              d3.selectAll(".event-connector").remove();

              // Remove tooltip
              d3.selectAll(".tooltip").remove();
            });

    // Add labels for events
    events.append("text")
            .attr("class", "timeline-label")
            .attr("x", 15)
            .attr("y", 4)
            .attr("text-anchor", "start")
            .text(d => d.label);

    createLegend(colorScale);
  }

  // Create a legend for the chart
  function createLegend(colorScale) {
    const legendData = [
      { category: "prep", label: "Preparation" },
      { category: "rice", label: "Rice Cooking" },
      { category: "rest", label: "Resting" },
      { category: "jhol", label: "Jhol Preparation" },
      { category: "layer", label: "Layering" },
      { category: "cook", label: "Cooking" },
      { category: "final", label: "Final Steps" }
    ];

    const legendContainer = d3.select("#legend");

    // Clear existing legend
    legendContainer.selectAll("*").remove();

    legendData.forEach(item => {
      const legendItem = legendContainer.append("div")
              .attr("class", "legend-item");

      legendItem.append("div")
              .attr("class", "legend-color")
              .style("background-color", colorScale(item.category));

      legendItem.append("span")
              .text(item.label);
    });
  }

  // Initialize the chart when the page loads
  document.addEventListener('DOMContentLoaded', function() {
    createVerticalTimeline();

    // Recreate chart on window resize
    window.addEventListener('resize', createVerticalTimeline);
  });
</script>
</body>
</html>