<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Wellness | Coherent Breathing - A Guide for All Levels</title>

    <link rel="stylesheet" href="../../../d3_templates/hierarchical_dendrogram.css">
    <link rel="stylesheet" href="../../../index.css">
    <link rel="stylesheet" href="../../../bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../../js/highlight/styles/default.css">
    <link rel="stylesheet" href="../../../external_libraries/bootstrap/bootstrap.min.css">

    <!-- Main CSS for this page -->
    <link rel="stylesheet" href="coherent_breathing.css">

    <script src="../../../d3/d3.v4.min.js"></script>
    <script src="../../../automation/loadObjects.js"></script>
    <script src="../../../js/highlight/highlight.pack.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>

    <script>hljs.initHighlightingOnLoad();</script>
</head>
<body>

<div class="container-lg card p-5">
    <div id="header_placeholder"></div>

    <h1 class="d-grid gap-3 justify-content-center p-2 mb-4" style="color: #8B4513;">Wellness | Coherent Breathing</h1>

    <p class="text-center mb-4" style="font-size: 1.1rem; color: #555;">
        A guided experience for everyone - from absolute beginners to breathing experts.<br>
        Choose your level to get started:
    </p>

    <!-- Level Navigation -->
    <div class="row mb-5">
        <div class="col-md-4 mb-3">
            <div class="card text-center h-100 level-card" id="beginnerCard"
                 onclick="scrollToSection('beginnerSection')" style="cursor: pointer;">
                <div class="card-body">
                    <h3 class="card-title beginner-color">üå± Beginner</h3>
                    <p class="card-text">New to coherent breathing? Start here with educational videos to understand the
                        basics.</p>
                    <div class="badge beginner-badge">Start Here</div>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card text-center h-100 level-card" id="practitionerCard"
                 onclick="scrollToSection('practitionerSection')" style="cursor: pointer;">
                <div class="card-body">
                    <h3 class="card-title practitioner-color">üîÑ Practitioner</h3>
                    <p class="card-text">Familiar with the basics? Choose from established breathing patterns for
                        practice.</p>
                    <div class="badge practitioner-badge">Practice Patterns</div>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card text-center h-100 level-card" id="expertCard" onclick="scrollToSection('expertSection')"
                 style="cursor: pointer;">
                <div class="card-body">
                    <h3 class="card-title expert-color">üéõÔ∏è Expert</h3>
                    <p class="card-text">Ready for advanced practice? Create custom breathing patterns tailored to your
                        needs.</p>
                    <div class="badge expert-badge">Custom Creator</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Section 1: Beginner -->
    <div id="beginnerSection" class="level-section mt-5">
        <div class="section-header beginner-header">
            <h3 class="beginner-color center-flex">üå± Beginner Level | Learn the Basics</h3>
            <p class="center-flex justify-content-center">Start your coherent breathing journey with these educational
                videos. Learn what
                coherent breathing is, why it works, and how to get started.</p>
        </div>

        <div class="row mt-4">
            <div class="col-lg-6 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title beginner-color text-center">üé• What is Coherent Breathing?</h5>
                        <p class="card-text">Learn the fundamentals of coherent breathing and how it benefits your
                            nervous system.</p>
                        <div class="video-container">
                            <iframe
                                    class="w-100"
                                    height="315"
                                    src="https://www.youtube.com/embed/q06YIWCR2Js"
                                    title="What is Coherent Breathing?"
                                    frameborder="0"
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                    referrerpolicy="strict-origin-when-cross-origin"
                                    allowfullscreen>
                            </iframe>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-6 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title beginner-color text-center">üéì The Science Behind It</h5>
                        <p class="card-text">Understand the science of heart rate variability and why 5.5-5.5 breathing
                            is optimal.</p>
                        <div class="video-container">
                            <iframe
                                    class="w-100"
                                    height="315"
                                    src="https://www.youtube.com/embed/Q_fFattg8N0?pp=ygUnYmVpbmcgYnJpbGxpYW50IGV2ZXJ5IHNpbmdsZSBkYXkgcGFydCAy2AYD"
                                    title="Science of Coherent Breathing"
                                    frameborder="0"
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                    referrerpolicy="strict-origin-when-cross-origin"
                                    allowfullscreen>
                            </iframe>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card mt-4 tips-card">
            <div class="card-body">
                <h5 class="card-title beginner-color collapsible-header"
                    onclick="toggleCollapse('beginnerChecklist', this)">
                    üìù Beginner's Checklist
                    <span class="collapse-icon">‚ñº</span>
                </h5>
                <div class="collapsible-content" id="beginnerChecklist">
                    <ul>
                        <li>‚úÖ Watch both videos to understand the concept</li>
                        <li>‚úÖ Find a comfortable, quiet place to practice</li>
                        <li>‚úÖ Start with just 5 minutes per day</li>
                        <li>‚úÖ Focus on consistency rather than duration</li>
                        <li>‚úÖ Move to Practitioner level when ready to try patterns</li>
                    </ul>
                    <div class="text-center">
                        <button class="btn beginner-btn btn-sm" onclick="scrollToSection('practitionerSection')">
                            ü°á Ready to Practice? Go to Practitioner Level
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Section 2: Practitioner -->
    <div id="practitionerSection" class="level-section mt-5">
        <div class="section-header practitioner-header">
            <h3 class="practitioner-color text-center">üîÑ Practitioner Level | Practice with Patterns</h3>
            <p class="">Choose from established breathing patterns. Each pattern is designed for specific benefits.
                Start with the standard 5.5-5.5 pattern for optimal results.</p>
        </div>

        <!-- Unified Audio Controls -->
        <div class="audio-controls">
            <!-- Unified Control Panel -->
            <div class="row">
                <div class="unified-control-panel mb-4 col-12">
                    <div class="control-panel-inner">
                        <!-- Session Timer Display -->
                        <div class="session-timer-inline">
                            <div class="timer-label">Session Timer</div>
                            <div class="session-timer" id="sessionTimer">00:00:00</div>
                        </div>

                        <!-- Play/Pause/Stop Buttons -->
                        <div class="unified-buttons">
                            <button class="btn btn-primary btn-lg unified-play" id="unifiedPlay" disabled>
                                ‚ñ∂Ô∏è Play
                            </button>
                            <button class="btn btn-secondary btn-lg unified-pause" id="unifiedPause" disabled>
                                ‚è∏Ô∏è Pause
                            </button>
                            <button class="btn btn-outline-secondary btn-lg unified-stop" id="unifiedStop" disabled>
                                ‚èπÔ∏è Stop
                            </button>
                        </div>

                        <!-- Status Display -->
                        <div class="unified-status">
                            <span class="loading-status" id="unifiedLoadingStatus">Loading audio files...</span>
                            <span class="selected-pattern"
                                  id="selectedPatternDisplay">Selected: 5.5-5.5 (Standard)</span>
                        </div>
                    </div>
                </div>


            </div>

            <!-- Pattern Selection Cards -->
            <h5 class="text-center mb-3" style="color: #666;">Select a Pattern:</h5>


            <!-- Other Patterns Grid -->
            <div class="row">

                <!-- Standard Pattern (Highlighted) -->
                <div class="col-md-6 mb-3">
                    <div>
                        <div class="pattern-selector-card selected standard-pattern-highlight"
                             data-pattern-id="55.5"
                             data-audio-url="Coherent_Piano_5.5_5.5_fermibot.mp3"
                             onclick="selectPattern(this)">
                            <div class="pattern-selector-content">
                                <div class="pattern-radio">
                                    <span class="radio-indicator"></span>
                                </div>
                                <div class="pattern-info">
                                    <h5 class="pattern-title">‚≠ê 5.5-5.5 Breathing Pattern
                                    </h5>
                                    <p class="pattern-description mb-0">5.5s inhale, 5.5s exhale | For optimal
                                        HRV <span class="badge bg-success">Standard</span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6 mb-3">
                    <div class="pattern-selector-card"
                         data-pattern-id="55"
                         data-audio-url="Coherent_Piano_5_5_fermibot.mp3"
                         onclick="selectPattern(this)">
                        <div class="pattern-selector-content">
                            <div class="pattern-radio">
                                <span class="radio-indicator"></span>
                            </div>
                            <div class="pattern-info">
                                <h5 class="pattern-title">üåº 5-5 Breathing Pattern</h5>
                                <p class="pattern-description mb-0">5s inhale, 5s exhale | For energy and focus</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6 mb-3">
                    <div class="pattern-selector-card"
                         data-pattern-id="66"
                         data-audio-url="Coherent_Piano_6_6_fermibot.mp3"
                         onclick="selectPattern(this)">
                        <div class="pattern-selector-content">
                            <div class="pattern-radio">
                                <span class="radio-indicator"></span>
                            </div>
                            <div class="pattern-info">
                                <h5 class="pattern-title">üå∏ 6-6 Breathing Pattern</h5>
                                <p class="pattern-description mb-0">6s inhale, 6s exhale | Perfect for relaxation</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6 mb-3">
                    <div class="pattern-selector-card"
                         data-pattern-id="77"
                         data-audio-url="Coherent_Piano_7_7_fermibot.mp3"
                         onclick="selectPattern(this)">
                        <div class="pattern-selector-content">
                            <div class="pattern-radio">
                                <span class="radio-indicator"></span>
                            </div>
                            <div class="pattern-info">
                                <h5 class="pattern-title">üåø 7-7 Breathing Pattern</h5>
                                <p class="pattern-description mb-0">7s inhale, 7s exhale | For deep relaxation</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6 mb-3">
                    <div class="pattern-selector-card"
                         data-pattern-id="88"
                         data-audio-url="Coherent_Piano_8_8_fermibot.mp3"
                         onclick="selectPattern(this)">
                        <div class="pattern-selector-content">
                            <div class="pattern-radio">
                                <span class="radio-indicator"></span>
                            </div>
                            <div class="pattern-info">
                                <h5 class="pattern-title">üåä 8-8 Breathing Pattern</h5>
                                <p class="pattern-description mb-0">8s inhale, 8s exhale | For meditation & calm</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="text-center mt-3">
                <p class="text-muted" style="font-size: 0.9rem;">
                    <strong>Note:</strong> Using Web Audio API for seamless looping without gaps between cycles.
                    Select a pattern above, then use the unified controls to play.
                </p>
            </div>
        </div>

        <!-- Practitioner Tips -->
        <div class="card mt-4 tips-card">
            <div class="card-body">
                <h5 class="card-title practitioner-color collapsible-header"
                    onclick="toggleCollapse('practitionerTips', this)">
                    üí° Practitioner Tips
                    <span class="collapse-icon">‚ñº</span>
                </h5>
                <div class="collapsible-content" id="practitionerTips">
                    <ul>
                        <li>‚úÖ Start with the 5.5-5.5 pattern for best heart rate variability results</li>
                        <li>‚úÖ Practice for 10-20 minutes daily for noticeable benefits</li>
                        <li>‚úÖ Breathe through your nose with your belly expanding</li>
                        <li>‚úÖ Keep your eyes closed and focus on the piano tones</li>
                        <li>‚úÖ Gradually increase duration as you become more comfortable</li>
                    </ul>
                    <div class="text-center">
                        <button class="btn beginner-btn btn-sm" onclick="scrollToSection('beginnerSection')">
                            ü°Ö Back to Beginner Level
                        </button>
                        <button class="btn practitioner-btn btn-sm" onclick="scrollToSection('expertSection')">
                            ü°á Ready to Customize? Go to Expert Level
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Section 3: Expert -->
    <div id="expertSection" class="level-section mt-5">
        <div class="section-header expert-header">
            <h3 class="expert-color text-center">üéõÔ∏è Expert Level | Custom Pattern Creator</h3>
            <p class="">Create your own breathing patterns with customizable inhale, exhale, and pause durations.
                Perfect for advanced practitioners who want to explore different breathing techniques.</p>
        </div>

        <div class="programmable-section" id="programmableSection">
            <!-- Custom Timer Display - At Top Like Practitioner Section -->

            <div class="row">

                <div class="custom-timer-container-top mb-4 col-6">
                    <div class="custom-timer-label">Custom Pattern Timer</div>
                    <div class="custom-timer" id="customPatternTimer">00:00:00</div>
                    <div class="mt-2" style="font-size: 0.9rem; color: #6c757d;">
                        ‚è±Ô∏è Timer resets when you stop. Tracks only this custom pattern session.
                    </div>
                </div>

                <div class="custom-timer-container-top mb-4 col-6">
                    <!-- Breath cycle visualizer -->
                    <div class="breath-visualizer" id="breathVisualizer">
                        <!-- Phases will be dynamically inserted here --></div>


                    <div class="row">
                        <!-- Current phase indicator -->
                        <div class="current-phase-indicator col-6" id="currentPhase">Ready to start</div>

                        <!-- Cycle counter -->
                        <div class="current-phase-indicator col-6" id="cycleCounter"> Cycle: 0</div>

                    </div>
                </div>

            </div>

            <div class="row">
                <!-- Left side: Controls -->
                <div class="col-lg-6">
                    <div class="programmable-card">
                        <h5 class="expert-color text-center">‚öôÔ∏è Pattern Configuration</h5>

                        <!-- Duration selectors -->
                        <div class="row mt-4">
                            <div class="col-6 mb-3">
                                <label class="duration-label">Inhale Duration</label>
                                <select class="form-select" id="inDuration">
                                    <option value="3">3 seconds</option>
                                    <option value="4">4 seconds</option>
                                    <option value="5">5 seconds</option>
                                    <option value="5.5" selected>5.5 seconds</option>
                                    <option value="6">6 seconds</option>
                                    <option value="7">7 seconds</option>
                                    <option value="8">8 seconds</option>
                                    <option value="9">9 seconds</option>
                                </select>
                            </div>
                            <div class="col-6 mb-3">
                                <label class="duration-label">Pause After Inhale</label>
                                <select class="form-select" id="pause1Duration">
                                    <option value="0" selected>No pause</option>
                                    <option value="1">1 second</option>
                                    <option value="2">2 seconds</option>
                                    <option value="3">3 seconds</option>
                                    <option value="4">4 seconds</option>
                                    <option value="5">5 seconds</option>
                                    <option value="6">6 seconds</option>
                                    <option value="7">7 seconds</option>
                                    <option value="8">8 seconds</option>
                                </select>
                            </div>
                            <div class="col-6 mb-3">
                                <label class="duration-label">Exhale Duration</label>
                                <select class="form-select" id="outDuration">
                                    <option value="3">3 seconds</option>
                                    <option value="4">4 seconds</option>
                                    <option value="5">5 seconds</option>
                                    <option value="5.5" selected>5.5 seconds</option>
                                    <option value="6">6 seconds</option>
                                    <option value="7">7 seconds</option>
                                    <option value="8">8 seconds</option>
                                    <option value="9">9 seconds</option>
                                </select>
                            </div>
                            <div class="col-6 mb-3">
                                <label class="duration-label">Pause After Exhale</label>
                                <select class="form-select" id="pause2Duration">
                                    <option value="0" selected>No pause</option>
                                    <option value="1">1 second</option>
                                    <option value="2">2 seconds</option>
                                    <option value="3">3 seconds</option>
                                    <option value="4">4 seconds</option>
                                    <option value="5">5 seconds</option>
                                    <option value="6">6 seconds</option>
                                    <option value="7">7 seconds</option>
                                    <option value="8">8 seconds</option>
                                </select>
                            </div>
                        </div>

                        <!-- Control buttons -->
                        <div class="d-flex justify-content-center gap-2 mt-3">
                            <button class="btn btn-outline-primary btn-play" id="programmablePlay" disabled>
                                ‚ñ∂Ô∏è Play Pattern
                            </button>
                            <button class="btn btn-outline-secondary btn-pause" id="programmablePause" disabled>
                                ‚è∏Ô∏è Pause
                            </button>
                            <button class="btn btn-outline-secondary btn-stop" id="programmableStop" disabled>
                                ‚èπÔ∏è Stop
                            </button>
                        </div>

                        <div class="audio-status text-center mt-2">
                            <span id="programmableLoading" class="audio-loading">Loading custom audio files...</span>
                        </div>
                    </div>
                </div>

                <!-- Right side: Visualizer and Summary -->
                <div class="col-6">
                    <div class="programmable-card">


                        <!-- Pattern summary -->
                        <div class="pattern-summary">
                            <h6>Current Pattern Summary</h6>
                            <div class="pattern-summary-item">
                                <span class="pattern-summary-label">Inhale:</span>
                                <span class="pattern-summary-value" id="summaryIn">5.5s</span>
                            </div>
                            <div class="pattern-summary-item">
                                <span class="pattern-summary-label">Pause 1:</span>
                                <span class="pattern-summary-value" id="summaryPause1">0s</span>
                            </div>
                            <div class="pattern-summary-item">
                                <span class="pattern-summary-label">Exhale:</span>
                                <span class="pattern-summary-value" id="summaryOut">5.5s</span>
                            </div>
                            <div class="pattern-summary-item">
                                <span class="pattern-summary-label">Pause 2:</span>
                                <span class="pattern-summary-value" id="summaryPause2">0s</span>
                            </div>
                            <div class="total-duration" id="totalDuration">
                                Total: 11s per cycle
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Expert Tips Card (New section, similar to practitioner tips) -->
        <div class="card mt-4 tips-card">
            <div class="card-body">
                <h5 class="card-title expert-color collapsible-header" onclick="toggleCollapse('expertTips', this)">
                    üí° Expert Tips
                    <span class="collapse-icon">‚ñº</span>
                </h5>
                <div class="collapsible-content" id="expertTips">
                    <ul>
                        <li>‚úÖ Longer exhales (compared to inhales) promote relaxation</li>
                        <li>‚úÖ Add pauses to increase mindfulness and breath awareness</li>
                        <li>‚úÖ Experiment with 4-7-8 pattern (inhale 4s, hold 7s, exhale 8s)</li>
                        <li>‚úÖ Try box breathing (4-4-4-4 pattern) for focus and stress reduction</li>
                        <li>‚úÖ Save successful patterns in a journal for future reference</li>
                        <li>‚úÖ Adjust patterns based on your energy levels and time of day</li>
                    </ul>
                    <div class="text-center">
                        <button class="btn expert-btn btn-sm" onclick="scrollToSection('beginnerSection')">
                            ü°Ö Back to Beginner Level
                        </button>
                        <button class="btn practitioner-btn btn-sm" onclick="scrollToSection('practitionerSection')">
                            ü°Ö Back to Practitioner Level
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="card mt-4">
            <div class="card-body">
                <h5 class="expert-color text-center">üìä Expert Pattern Ideas</h5>
                <p class="text-center text-muted small mb-3">Click any pattern to apply it to the custom pattern creator
                    above</p>

                <!-- Pattern Ideas Grid - 3 per row -->
                <div class="row">
                    <!-- Row 1 -->
                    <div class="col-md-4 mb-3">
                        <div class="card h-100 pattern-idea-card"
                             data-in="4" data-pause1="0" data-out="8" data-pause2="0"
                             onclick="applyPatternIdea(this)">
                            <div class="card-body text-center">
                                <h6 class="card-title expert-color">üåä Calming Pattern</h6>
                                <p class="card-text pattern-description">Inhale: 4s<br>Exhale: 8s<br>Creates deep
                                    relaxation</p>
                                <div class="text-muted small">Perfect for evening</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="card h-100 pattern-idea-card"
                             data-in="4" data-pause1="4" data-out="4" data-pause2="4"
                             onclick="applyPatternIdea(this)">
                            <div class="card-body text-center">
                                <h6 class="card-title expert-color">üì¶ Box Breathing <sup><a href="#ref-box"
                                                                                            class="footnote-link">[1]</a></sup>
                                </h6>
                                <p class="card-text pattern-description">Inhale: 4s<br>Hold: 4s<br>Exhale: 4s<br>Hold:
                                    4s</p>
                                <div class="text-muted small">Used by Navy SEALs</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="card h-100 pattern-idea-card"
                             data-in="4" data-pause1="4" data-out="6" data-pause2="2"
                             onclick="applyPatternIdea(this)">
                            <div class="card-body text-center">
                                <h6 class="card-title expert-color">üî∑ Rectangular <sup><a href="#ref-rect"
                                                                                          class="footnote-link">[2]</a></sup>
                                </h6>
                                <p class="card-text pattern-description">Inhale: 4s<br>Hold: 4s<br>Exhale: 6s<br>Hold:
                                    2s</p>
                                <div class="text-muted small">SIU Medicine</div>
                            </div>
                        </div>
                    </div>

                    <!-- Row 2 -->
                    <div class="col-md-4 mb-3">
                        <div class="card h-100 pattern-idea-card"
                             data-in="4" data-pause1="4" data-out="8" data-pause2="0"
                             onclick="applyPatternIdea(this)">
                            <div class="card-body text-center">
                                <h6 class="card-title expert-color">üßò 4-4-8 Pattern <sup><a href="#ref-448"
                                                                                            class="footnote-link">[3]</a></sup>
                                </h6>
                                <p class="card-text pattern-description">Inhale: 4s<br>Hold: 4s<br>Exhale: 8s</p>
                                <div class="text-muted small">Research-backed relaxation</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="card h-100 pattern-idea-card"
                             data-in="4" data-pause1="7" data-out="8" data-pause2="0"
                             onclick="applyPatternIdea(this)">
                            <div class="card-body text-center">
                                <h6 class="card-title expert-color">üò¥ 4-7-8 Sleep <sup><a href="#ref-478"
                                                                                          class="footnote-link">[4]</a></sup>
                                </h6>
                                <p class="card-text pattern-description">Inhale: 4s<br>Hold: 7s<br>Exhale: 8s</p>
                                <div class="text-muted small">Dr. Andrew Weil</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="card h-100 pattern-idea-card"
                             data-in="5.5" data-pause1="0" data-out="5.5" data-pause2="0"
                             onclick="applyPatternIdea(this)">
                            <div class="card-body text-center">
                                <h6 class="card-title expert-color">‚ù§Ô∏è Heart Coherence <sup><a href="#ref-coherence"
                                                                                               class="footnote-link">[5]</a></sup>
                                </h6>
                                <p class="card-text pattern-description">Inhale: 5.5s<br>Exhale: 5.5s<br>Optimal HRV</p>
                                <div class="text-muted small">Back to basics</div>
                            </div>
                        </div>
                    </div>

                    <!-- Row 3 -->
                    <div class="col-md-4 mb-3">
                        <div class="card h-100 pattern-idea-card"
                             data-in="3" data-pause1="0" data-out="8" data-pause2="0"
                             onclick="applyPatternIdea(this)">
                            <div class="card-body text-center">
                                <h6 class="card-title expert-color">üå¨Ô∏è Physiological Sigh <sup><a href="#ref-sigh"
                                                                                                  class="footnote-link">[6]</a></sup>
                                </h6>
                                <p class="card-text pattern-description">Inhale: 3s<br>Exhale: 8s<br>Immediate Reset</p>
                                <div class="text-muted small">Stanford Neurobiology</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="card h-100 pattern-idea-card"
                             data-in="4" data-pause1="4" data-out="4" data-pause2="0"
                             onclick="applyPatternIdea(this)">
                            <div class="card-body text-center">
                                <h6 class="card-title expert-color">üî∫ Triangle <sup><a href="#ref-triangle"
                                                                                       class="footnote-link">[7]</a></sup>
                                </h6>
                                <p class="card-text pattern-description">Inhale: 4s<br>Hold: 4s<br>Exhale: 4s<br>Anti-Anxiety
                                </p>
                                <div class="text-muted small">Low-Stress Grounding</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="card h-100 pattern-idea-card"
                             data-in="4" data-pause1="0" data-out="6" data-pause2="0"
                             onclick="applyPatternIdea(this)">
                            <div class="card-body text-center">
                                <h6 class="card-title expert-color">ü©∫ Resonance 4:6 <sup><a href="#ref-resonance"
                                                                                            class="footnote-link">[8]</a></sup>
                                </h6>
                                <p class="card-text pattern-description">Inhale: 4s<br>Exhale: 6s<br>Blood Pressure</p>
                                <div class="text-muted small">Clinical Biofeedback</div>
                            </div>
                        </div>
                    </div>

                    <!-- Row 4 -->
                    <div class="col-md-4 mb-3">
                        <div class="card h-100 pattern-idea-card"
                             data-in="3" data-pause1="0" data-out="6" data-pause2="0"
                             onclick="applyPatternIdea(this)">
                            <div class="card-body text-center">
                                <h6 class="card-title expert-color">üß† Vagal Loading <sup><a href="#ref-vagal"
                                                                                            class="footnote-link">[9]</a></sup>
                                </h6>
                                <p class="card-text pattern-description">Inhale: 3s<br>Exhale: 6s<br>Deep Calm</p>
                                <div class="text-muted small">Polyvagal Theory</div>
                            </div>
                        </div>
                    </div>

                    <!-- Add more patterns here - they will automatically flow into rows of 3 -->
                </div>

                <!-- References Section -->
                <div class="references-section mt-4 pt-3 border-top">
                    <h6 class="text-muted mb-2">üìö References <span
                            class="small fw-normal">(click pattern name to apply)</span></h6>
                    <ol class="references-list">
                        <li id="ref-box">
                            <strong class="reference-pattern-name" data-in="4" data-pause1="4" data-out="4"
                                    data-pause2="4" onclick="applyPatternFromReference(this)">Box Breathing:</strong>
                            <a href="https://health.clevelandclinic.org/box-breathing-benefits" target="_blank"
                               rel="noopener">Cleveland Clinic - Box Breathing Benefits</a>,
                            <a href="https://www.bhf.org.uk/informationsupport/heart-matters-magazine/wellbeing/breathing-exercises"
                               target="_blank" rel="noopener">British Heart Foundation - Breathing Exercises</a>
                        </li>
                        <li id="ref-rect">
                            <strong class="reference-pattern-name" data-in="4" data-pause1="4" data-out="6"
                                    data-pause2="2" onclick="applyPatternFromReference(this)">Rectangular
                                Breathing:</strong>
                            <a href="https://www.siumed.edu/gme/breath-wellness" target="_blank" rel="noopener">SIU
                                Medicine - Breath for Wellness</a>
                        </li>
                        <li id="ref-448">
                            <strong class="reference-pattern-name" data-in="4" data-pause1="4" data-out="8"
                                    data-pause2="0" onclick="applyPatternFromReference(this)">4-4-8 Breathing:</strong>
                            <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC11229811/" target="_blank" rel="noopener">PMC/NIH
                                - Breathing Pattern Research</a>
                        </li>
                        <li id="ref-478">
                            <strong class="reference-pattern-name" data-in="4" data-pause1="7" data-out="8"
                                    data-pause2="0" onclick="applyPatternFromReference(this)">4-7-8 Breathing:</strong>
                            <a href="https://health.clevelandclinic.org/4-7-8-breathing" target="_blank" rel="noopener">Cleveland
                                Clinic - 4-7-8 Breathing</a>,
                            <a href="https://www.bhf.org.uk/informationsupport/heart-matters-magazine/wellbeing/breathing-exercises"
                               target="_blank" rel="noopener">British Heart Foundation - Breathing Exercises</a>
                        </li>
                        <li id="ref-coherence">
                            <strong class="reference-pattern-name" data-in="5.5" data-pause1="0" data-out="5.5"
                                    data-pause2="0" onclick="applyPatternFromReference(this)">Heart Coherence
                                (5.5-5.5):</strong>
                            <a href="https://pubmed.ncbi.nlm.nih.gov/24380741/" target="_blank" rel="noopener">PubMed -
                                Heart Rate Variability & Breathing Research</a>
                        </li>
                        <li id="ref-sigh">
                            <strong class="reference-pattern-name" data-in="3" data-pause1="0" data-out="8"
                                    data-pause2="0" onclick="applyPatternFromReference(this)">Physiological
                                Sigh:</strong>
                            <a href="https://doi.org/10.1016/j.xcrm.2022.100895" target="_blank" rel="noopener">Stanford
                                - Cell Reports Medicine</a>
                        </li>
                        <li id="ref-triangle">
                            <strong class="reference-pattern-name" data-in="4" data-pause1="4" data-out="4"
                                    data-pause2="0" onclick="applyPatternFromReference(this)">Triangle
                                Breathing:</strong>
                            <a href="https://doi.org/10.3390/brainsci13121612" target="_blank" rel="noopener">Brain
                                Sciences Journal</a>,
                            <a href="https://digitalcommons.lesley.edu/educational_studies_dissertations/1001"
                               target="_blank" rel="noopener">Lesley University Research</a>
                        </li>
                        <li id="ref-resonance">
                            <strong class="reference-pattern-name" data-in="4" data-pause1="0" data-out="6"
                                    data-pause2="0" onclick="applyPatternFromReference(this)">Resonance Breathing
                                (4:6):</strong>
                            <a href="https://doi.org/10.1152/ajpheart.01011.2013" target="_blank" rel="noopener">American
                                Journal of Physiology - Heart</a>
                        </li>
                        <li id="ref-vagal">
                            <strong class="reference-pattern-name" data-in="3" data-pause1="0" data-out="6"
                                    data-pause2="0" onclick="applyPatternFromReference(this)">Vagal Loading:</strong>
                            <a href="https://doi.org/10.3390/medicines7100065" target="_blank" rel="noopener">MDPI
                                Medicines - Polyvagal Theory</a>
                        </li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <div id="footer_placeholder"></div>
</div>

<script>
    loadHeaderFooter("../../../automation/header.html", "../../../automation/footer.html", "../../../automation/theme_toggle.html")

    // Smooth scrolling function
    function scrollToSection(sectionId) {
        document.getElementById(sectionId).scrollIntoView({
            behavior: 'smooth'
        });

        // Highlight the clicked level card
        document.querySelectorAll('.level-card').forEach(card => {
            card.classList.remove('active-level');
        });
        document.getElementById(sectionId + 'Card').classList.add('active-level');
    }

    // Toggle collapsible sections
    function toggleCollapse(contentId, headerElement) {
        const content = document.getElementById(contentId);
        const icon = headerElement.querySelector('.collapse-icon');

        content.classList.toggle('collapsed');
        headerElement.classList.toggle('collapsed');

        if (content.classList.contains('collapsed')) {
            icon.textContent = '‚ñ∂';
        } else {
            icon.textContent = '‚ñº';
        }
    }

    // Apply pattern idea to custom pattern creator
    function applyPatternIdea(card) {
        // Get pattern values from data attributes
        const inDuration = card.dataset.in;
        const pause1Duration = card.dataset.pause1;
        const outDuration = card.dataset.out;
        const pause2Duration = card.dataset.pause2;

        // Set the select element values
        document.getElementById('inDuration').value = inDuration;
        document.getElementById('pause1Duration').value = pause1Duration;
        document.getElementById('outDuration').value = outDuration;
        document.getElementById('pause2Duration').value = pause2Duration;

        // Remove selected class from all pattern idea cards
        document.querySelectorAll('.pattern-idea-card').forEach(c => {
            c.classList.remove('pattern-idea-selected');
        });

        // Add selected class to clicked card
        card.classList.add('pattern-idea-selected');

        // Clear all reference highlights
        document.querySelectorAll('.reference-pattern-name').forEach(r => {
            r.classList.remove('reference-pattern-selected');
        });

        // Highlight corresponding reference if pattern has a footnote link
        const footnoteLink = card.querySelector('.footnote-link');
        if (footnoteLink) {
            const refId = footnoteLink.getAttribute('href'); // e.g., "#ref-box"
            if (refId) {
                const refElement = document.querySelector(refId + ' .reference-pattern-name');
                if (refElement) {
                    refElement.classList.add('reference-pattern-selected');
                }
            }
        }

        // Trigger the update in the programmable sequencer
        if (window.audioPlayers && window.audioPlayers.programmableSequencer) {
            window.audioPlayers.programmableSequencer.updateSettings();
        }

        // Scroll to the pattern configuration section
        document.getElementById('programmableSection').scrollIntoView({
            behavior: 'smooth',
            block: 'start'
        });

        // Show a brief visual feedback
        const patternName = card.querySelector('.card-title').textContent;
        showPatternAppliedFeedback(patternName);
    }

    // Apply pattern from reference section
    function applyPatternFromReference(element) {
        // Get pattern values from data attributes
        const inDuration = element.dataset.in;
        const pause1Duration = element.dataset.pause1;
        const outDuration = element.dataset.out;
        const pause2Duration = element.dataset.pause2;

        // Set the select element values
        document.getElementById('inDuration').value = inDuration;
        document.getElementById('pause1Duration').value = pause1Duration;
        document.getElementById('outDuration').value = outDuration;
        document.getElementById('pause2Duration').value = pause2Duration;

        // Clear all pattern card highlights
        document.querySelectorAll('.pattern-idea-card').forEach(c => {
            c.classList.remove('pattern-idea-selected');
        });

        // Clear all reference highlights, then highlight this one
        document.querySelectorAll('.reference-pattern-name').forEach(r => {
            r.classList.remove('reference-pattern-selected');
        });
        element.classList.add('reference-pattern-selected');

        // Trigger the update in the programmable sequencer
        if (window.audioPlayers && window.audioPlayers.programmableSequencer) {
            window.audioPlayers.programmableSequencer.updateSettings();
        }

        // Show a brief visual feedback
        const patternName = element.textContent.replace(':', '');
        showPatternAppliedFeedback(patternName);

        // Scroll to the pattern configuration section
        document.getElementById('programmableSection').scrollIntoView({
            behavior: 'smooth',
            block: 'start'
        });
    }

    // Show feedback when pattern is applied
    function showPatternAppliedFeedback(patternName) {
        // Create or get feedback element
        let feedback = document.getElementById('patternAppliedFeedback');
        if (!feedback) {
            feedback = document.createElement('div');
            feedback.id = 'patternAppliedFeedback';
            feedback.className = 'pattern-applied-feedback';
            document.body.appendChild(feedback);
        }

        // Clean pattern name
        const cleanName = patternName.replace(/\s*\[\d+\]\s*/g, '').trim();
        feedback.textContent = `‚úì ${cleanName} applied!`;
        feedback.classList.add('show');

        // Hide after 2 seconds
        setTimeout(() => {
            feedback.classList.remove('show');
        }, 2000);
    }
</script>

<!-- Main JavaScript files -->
<script src="coherent_breathing_audio.js"></script>
<script src="coherent_breathing_programmable.js"></script>
<script src="coherent_breathing_main.js"></script>

</body>
</html>