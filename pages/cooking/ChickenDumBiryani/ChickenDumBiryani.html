<!DOCTYPE html>
<html lang="en" data-bs-theme="auto">
<head>
    <meta charset="UTF-8">
    <title>Chicken Dum Biryani</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="../../../bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../../index.css">
    <link rel="stylesheet" href="ChickenDumBiryani.css">

    <script src="../../../external_libraries/bootstrap/jquery.min.js"></script>
    <script src="../../../external_libraries/bootstrap/popper.min.js"></script>
    <script src="../../../external_libraries/bootstrap/bootstrap.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="../../../automation/loadObjects.js"></script>
</head>

<body>

<div id="header_placeholder"></div>

<div class="hero-section">
    <div class="container">
        <h1 class="hero-title">Chicken Dum Biryani</h1>
        <p class="hero-subtitle">A Royal Mughlai Delicacy</p>
        <div class="hero-meta">
            <span class="meta-badge">‚è± 4+ hours</span>
            <span class="meta-badge">üî• Medium</span>
            <span class="meta-badge">üçΩÔ∏è 4 servings</span>
        </div>
    </div>
</div>

<div class="container my-5">

    <section class="visualization-section mb-5">
        <h2 class="section-heading">Interactive Recipe Timeline</h2>
        <p class="section-description">Click any ingredient group to expand and see detailed breakdown ‚Ä¢ Click event markers for info</p>
        <div id="timeline-diagram"></div>
    </section>

    <div class="row g-4">
        <div class="col-lg-6">
            <section class="content-card">
                <h2 class="section-heading">Ingredients</h2>

                <div class="ingredient-category">
                    <div class="category-header">
                        <span class="category-icon">üçö</span>
                        <span class="category-name">Rice Base</span>
                        <span class="category-toggle">+</span>
                    </div>
                    <div class="category-content">
                        <div class="ingredient-item">
                            <span class="ingredient-qty">1 kg</span>
                            <span class="ingredient-name">Basmati Rice</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">4</span>
                            <span class="ingredient-name">Cloves</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">¬Ω inch</span>
                            <span class="ingredient-name">Cinnamon</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">2 pods</span>
                            <span class="ingredient-name">Green Cardamom</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">¬º cup</span>
                            <span class="ingredient-name">Ghee</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">To taste</span>
                            <span class="ingredient-name">Salt</span>
                        </div>
                    </div>
                </div>

                <div class="ingredient-category">
                    <div class="category-header">
                        <span class="category-icon">üçó</span>
                        <span class="category-name">Chicken Marinade</span>
                        <span class="category-toggle">+</span>
                    </div>
                    <div class="category-content">
                        <div class="ingredient-item">
                            <span class="ingredient-qty">1 kg</span>
                            <span class="ingredient-name">Chicken with bone</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">¬Ω cup</span>
                            <span class="ingredient-name">Curd (beaten)</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">1 tbsp</span>
                            <span class="ingredient-name">Ginger Garlic paste</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">1 tsp</span>
                            <span class="ingredient-name">Coriander powder</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">1 tbsp</span>
                            <span class="ingredient-name">Degi chilli powder</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">¬Ω tsp</span>
                            <span class="ingredient-name">Green chilli paste</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">3-4</span>
                            <span class="ingredient-name">Green chillies (slit)</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">4 medium</span>
                            <span class="ingredient-name">Onions (sliced)</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">2 tbsp</span>
                            <span class="ingredient-name">Fried onions</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">2 sprigs</span>
                            <span class="ingredient-name">Mint leaves</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">1 tbsp</span>
                            <span class="ingredient-name">Saffron water</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">To taste</span>
                            <span class="ingredient-name">Salt</span>
                        </div>
                    </div>
                </div>

                <div class="ingredient-category">
                    <div class="category-header">
                        <span class="category-icon">‚ú®</span>
                        <span class="category-name">Dum & Garnish</span>
                        <span class="category-toggle">+</span>
                    </div>
                    <div class="category-content">
                        <div class="ingredient-item">
                            <span class="ingredient-qty">1 tbsp</span>
                            <span class="ingredient-name">Ghee</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">¬º cup</span>
                            <span class="ingredient-name">Water</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">¬Ω cup</span>
                            <span class="ingredient-name">Milk</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">2 tbsp</span>
                            <span class="ingredient-name">Saffron water</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">Few</span>
                            <span class="ingredient-name">Mint leaves</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">1 tbsp</span>
                            <span class="ingredient-name">Fried onions</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">¬Ω tsp</span>
                            <span class="ingredient-name">Rose water</span>
                        </div>
                        <div class="ingredient-item">
                            <span class="ingredient-qty">Few drops</span>
                            <span class="ingredient-name">Kewra water</span>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <div class="col-lg-6">
            <section class="content-card">
                <h2 class="section-heading">Method</h2>

                <div class="step-item">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3 class="step-title">Marinate Chicken</h3>
                        <p class="step-text">Combine chicken with curd, ginger garlic paste, spices, fried onions, and saffron water. Marinate overnight or minimum 3 hours.</p>
                    </div>
                </div>

                <div class="step-item">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3 class="step-title">Prepare Rice</h3>
                        <p class="step-text">Soak washed basmati rice for 20 minutes. Boil water with ghee, salt, and whole spices. Cook rice to 80% doneness.</p>
                    </div>
                </div>

                <div class="step-item">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3 class="step-title">Cook Chicken</h3>
                        <p class="step-text">Heat ghee in heavy-bottomed pan. Cook marinated chicken for 7-8 minutes until partially done.</p>
                    </div>
                </div>

                <div class="step-item">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h3 class="step-title">Layer Biryani</h3>
                        <p class="step-text">Create layers: rice base, chicken with gravy in middle, rice on top.</p>
                    </div>
                </div>

                <div class="step-item">
                    <div class="step-number">5</div>
                    <div class="step-content">
                        <h3 class="step-title">Add Aromatics</h3>
                        <p class="step-text">Pour saffron milk, rose water, and kewra water over layered biryani.</p>
                    </div>
                </div>

                <div class="step-item">
                    <div class="step-number">6</div>
                    <div class="step-content">
                        <h3 class="step-title">Dum Cooking</h3>
                        <p class="step-text">Seal pot tightly. Cook on low flame for 15-20 minutes. Rest 5 minutes before opening.</p>
                    </div>
                </div>

                <div class="step-item">
                    <div class="step-number">7</div>
                    <div class="step-content">
                        <h3 class="step-title">Serve</h3>
                        <p class="step-text">Gently mix or serve layered. Garnish with fried onions and fresh mint.</p>
                    </div>
                </div>
            </section>

            <section class="content-card mt-4">
                <h2 class="section-heading">Pro Tips</h2>
                <div class="tips-grid">
                    <div class="tip-item">
                        <span class="tip-icon">‚è∞</span>
                        <p class="tip-text">Marinate overnight for maximum flavor</p>
                    </div>
                    <div class="tip-item">
                        <span class="tip-icon">üçö</span>
                        <p class="tip-text">Cook rice to only 80% - it finishes in dum</p>
                    </div>
                    <div class="tip-item">
                        <span class="tip-icon">üî•</span>
                        <p class="tip-text">Low flame is key - steam does the cooking</p>
                    </div>
                    <div class="tip-item">
                        <span class="tip-icon">üßÖ</span>
                        <p class="tip-text">Crispy fried onions add texture</p>
                    </div>
                </div>
            </section>
        </div>
    </div>
</div>

<div id="footer_placeholder"></div>

<script>
const timelineData = {
    swimlanes: [
        {
            id: 'rice',
            name: 'Rice',
            color: '#10b981',
            icon: 'üçö',
            ingredients: [
                { name: 'Basmati Rice', qty: '1 kg' },
                { name: 'Cloves', qty: '4' },
                { name: 'Cinnamon', qty: '¬Ω inch' },
                { name: 'Cardamom', qty: '2 pods' },
                { name: 'Ghee', qty: '¬º cup' },
                { name: 'Salt', qty: 'to taste' }
            ]
        },
        {
            id: 'protein',
            name: 'Protein',
            color: '#ef4444',
            icon: 'üçó',
            ingredients: [
                { name: 'Chicken', qty: '1 kg' }
            ]
        },
        {
            id: 'spices',
            name: 'Spices',
            color: '#f59e0b',
            icon: 'üå∂Ô∏è',
            ingredients: [
                { name: 'Ginger Garlic', qty: '1 tbsp' },
                { name: 'Chilli Powder', qty: '1 tbsp' },
                { name: 'Coriander', qty: '1 tsp' },
                { name: 'Green Chilli Paste', qty: '¬Ω tsp' },
                { name: 'Green Chillies', qty: '3-4' }
            ]
        },
        {
            id: 'aromatics',
            name: 'Aromatics',
            color: '#8b5cf6',
            icon: 'üßÖ',
            ingredients: [
                { name: 'Onions', qty: '4 medium' },
                { name: 'Fried Onions', qty: '3 tbsp' },
                { name: 'Mint', qty: '2 sprigs' },
                { name: 'Saffron', qty: '3 tbsp' },
                { name: 'Rose Water', qty: '¬Ω tsp' },
                { name: 'Kewra', qty: 'drops' }
            ]
        },
        {
            id: 'liquids',
            name: 'Liquids',
            color: '#3b82f6',
            icon: 'üíß',
            ingredients: [
                { name: 'Curd', qty: '¬Ω cup' },
                { name: 'Milk', qty: '¬Ω cup' },
                { name: 'Water', qty: '¬º cup' },
                { name: 'Ghee', qty: '1 tbsp' }
            ]
        }
    ],
    events: [
        { id: 1, time: 0, name: 'Start Marination', duration: '3+ hrs', lanes: ['protein', 'spices', 'liquids', 'aromatics'] },
        { id: 2, time: 180, name: 'Soak Rice', duration: '20 mins', lanes: ['rice'] },
        { id: 3, time: 200, name: 'Boil Rice', duration: '10 mins', lanes: ['rice', 'spices', 'liquids'] },
        { id: 4, time: 210, name: 'Cook Chicken', duration: '8 mins', lanes: ['protein', 'liquids'] },
        { id: 5, time: 218, name: 'Layer Biryani', duration: '5 mins', lanes: ['rice', 'protein'] },
        { id: 6, time: 223, name: 'Add Aromatics', duration: '2 mins', lanes: ['liquids', 'aromatics'] },
        { id: 7, time: 225, name: 'Dum Cooking', duration: '20 mins', lanes: ['rice', 'protein', 'spices', 'aromatics', 'liquids'] },
        { id: 8, time: 245, name: 'Ready to Serve', duration: '‚Äî', lanes: [] }
    ]
};

let expandedLane = null;

function createTimeline() {
    const container = d3.select("#timeline-diagram");
    container.html('');

    const containerWidth = container.node().getBoundingClientRect().width;
    const margin = { top: 80, right: 200, bottom: 40, left: 80 };
    const width = Math.min(containerWidth - margin.left - margin.right, 1200);
    const height = 1100;

    const svg = container.append("svg")
        .attr("width", "100%")
        .attr("height", height + margin.top + margin.bottom)
        .attr("viewBox", [0, 0, width + margin.left + margin.right, height + margin.top + margin.bottom]);

    const g = svg.append("g")
        .attr("transform", `translate(${margin.left},${margin.top})`);

    const swimlaneWidth = width / timelineData.swimlanes.length;
    const timeScale = d3.scaleLinear().domain([0, 250]).range([0, height]);

    // Draw swimlanes
    timelineData.swimlanes.forEach((lane, i) => {
        const x = i * swimlaneWidth;
        const isExpanded = expandedLane === lane.id;

        const laneGroup = g.append("g")
            .attr("class", "swimlane")
            .attr("data-lane", lane.id)
            .style("cursor", "pointer")
            .on("click", function() {
                expandedLane = expandedLane === lane.id ? null : lane.id;
                createTimeline();
            });

        // Background
        laneGroup.append("rect")
            .attr("x", x)
            .attr("y", 0)
            .attr("width", swimlaneWidth)
            .attr("height", height)
            .attr("fill", lane.color)
            .attr("opacity", isExpanded ? 0.08 : 0.03)
            .attr("stroke", lane.color)
            .attr("stroke-width", isExpanded ? 2 : 1)
            .attr("stroke-opacity", isExpanded ? 0.4 : 0.15)
            .style("transition", "all 0.3s ease");

        // Header with icon
        const headerGroup = laneGroup.append("g")
            .attr("transform", `translate(${x + swimlaneWidth/2}, -40)`);

        headerGroup.append("circle")
            .attr("r", isExpanded ? 28 : 24)
            .attr("fill", lane.color)
            .attr("opacity", isExpanded ? 0.2 : 0.1)
            .style("transition", "all 0.3s ease");

        headerGroup.append("text")
            .attr("y", 8)
            .attr("text-anchor", "middle")
            .attr("fill", lane.color)
            .style("font-size", isExpanded ? "24px" : "20px")
            .style("transition", "all 0.3s ease")
            .text(lane.icon);

        headerGroup.append("text")
            .attr("y", 48)
            .attr("text-anchor", "middle")
            .attr("fill", lane.color)
            .style("font-size", isExpanded ? "15px" : "13px")
            .style("font-weight", "700")
            .style("transition", "all 0.3s ease")
            .text(lane.name);

        // Click indicator
        if (!isExpanded) {
            headerGroup.append("text")
                .attr("y", 65)
                .attr("text-anchor", "middle")
                .attr("fill", lane.color)
                .style("font-size", "10px")
                .style("opacity", 0.6)
                .text("Click to expand ‚Üì");
        } else {
            headerGroup.append("text")
                .attr("y", 65)
                .attr("text-anchor", "middle")
                .attr("fill", lane.color)
                .style("font-size", "10px")
                .style("opacity", 0.6)
                .text("Click to collapse ‚Üë");
        }

        // Center guideline
        laneGroup.append("line")
            .attr("x1", x + swimlaneWidth/2)
            .attr("y1", 0)
            .attr("x2", x + swimlaneWidth/2)
            .attr("y2", height)
            .attr("stroke", lane.color)
            .attr("stroke-width", isExpanded ? 2 : 1.5)
            .attr("stroke-opacity", isExpanded ? 0.4 : 0.2)
            .attr("stroke-dasharray", "6,6");

        // Expanded ingredient graph
        if (isExpanded) {
            const ingredientSpacing = Math.min(80, height / (lane.ingredients.length + 2));

            lane.ingredients.forEach((ingredient, idx) => {
                const yPos = (idx + 1) * ingredientSpacing + 50;
                const nodeX = x + swimlaneWidth/2;

                const ingredientNode = g.append("g")
                    .attr("class", "ingredient-node-expanded")
                    .attr("transform", `translate(${nodeX}, ${yPos})`);

                // Connection from center
                ingredientNode.append("line")
                    .attr("x1", 0)
                    .attr("y1", 0)
                    .attr("x2", 40)
                    .attr("y2", 0)
                    .attr("stroke", lane.color)
                    .attr("stroke-width", 2)
                    .attr("opacity", 0.4);

                // Ingredient card
                const card = ingredientNode.append("g")
                    .attr("transform", "translate(40, 0)");

                const cardWidth = 90;
                const cardHeight = 45;

                card.append("rect")
                    .attr("x", 0)
                    .attr("y", -cardHeight/2)
                    .attr("width", cardWidth)
                    .attr("height", cardHeight)
                    .attr("rx", 8)
                    .attr("fill", "var(--bg-card)")
                    .attr("stroke", lane.color)
                    .attr("stroke-width", 2)
                    .style("filter", "drop-shadow(0 3px 8px rgba(0,0,0,0.15))")
                    .style("cursor", "pointer");

                // Quantity badge
                card.append("rect")
                    .attr("x", 5)
                    .attr("y", -cardHeight/2 + 4)
                    .attr("width", cardWidth - 10)
                    .attr("height", 14)
                    .attr("rx", 3)
                    .attr("fill", lane.color)
                    .attr("opacity", 0.2);

                card.append("text")
                    .attr("x", cardWidth/2)
                    .attr("y", -cardHeight/2 + 14)
                    .attr("text-anchor", "middle")
                    .attr("fill", lane.color)
                    .style("font-size", "9px")
                    .style("font-weight", "700")
                    .text(ingredient.qty);

                // Ingredient name
                card.append("text")
                    .attr("x", cardWidth/2)
                    .attr("y", -cardHeight/2 + 32)
                    .attr("text-anchor", "middle")
                    .attr("fill", "var(--text-primary)")
                    .style("font-size", "10px")
                    .style("font-weight", "600")
                    .text(ingredient.name);

                // Hover effect
                card.on("mouseenter", function() {
                    d3.select(this).select("rect:first-child")
                        .transition().duration(200)
                        .attr("stroke-width", 3)
                        .style("filter", "drop-shadow(0 5px 15px rgba(0,0,0,0.25))");
                })
                .on("mouseleave", function() {
                    d3.select(this).select("rect:first-child")
                        .transition().duration(200)
                        .attr("stroke-width", 2)
                        .style("filter", "drop-shadow(0 3px 8px rgba(0,0,0,0.15))");
                });
            });
        }
    });

    // Draw events
    timelineData.events.forEach(event => {
        const y = timeScale(event.time);

        const eventGroup = g.append("g")
            .attr("class", "event-group")
            .attr("transform", `translate(0, ${y})`);

        // Timeline bar
        eventGroup.append("line")
            .attr("x1", 0)
            .attr("y1", 0)
            .attr("x2", width)
            .attr("y2", 0)
            .attr("stroke", "var(--border-color)")
            .attr("stroke-width", 2)
            .attr("opacity", 0.3);

        // Time marker (left)
        const timeMarker = eventGroup.append("g")
            .attr("transform", "translate(-60, 0)");

        timeMarker.append("rect")
            .attr("x", -20)
            .attr("y", -18)
            .attr("width", 40)
            .attr("height", 36)
            .attr("rx", 6)
            .attr("fill", "var(--bg-card)")
            .attr("stroke", "var(--border-color)")
            .attr("stroke-width", 1.5);

        timeMarker.append("text")
            .attr("text-anchor", "middle")
            .attr("y", 0)
            .attr("fill", "var(--text-primary)")
            .style("font-size", "11px")
            .style("font-weight", "700")
            .text(`${event.time}m`);

        // Event info (right)
        if (event.id !== 8) {
            const eventCard = eventGroup.append("g")
                .attr("transform", `translate(${width + 15}, 0)`);

            eventCard.append("rect")
                .attr("x", 0)
                .attr("y", -28)
                .attr("width", 130)
                .attr("height", 56)
                .attr("rx", 8)
                .attr("fill", "var(--bg-card)")
                .attr("stroke", "var(--border-color)")
                .attr("stroke-width", 1.5)
                .style("filter", "drop-shadow(0 2px 6px rgba(0,0,0,0.1))");

            eventCard.append("text")
                .attr("x", 65)
                .attr("y", -10)
                .attr("text-anchor", "middle")
                .attr("fill", "var(--text-primary)")
                .style("font-size", "11px")
                .style("font-weight", "700")
                .text(event.name);

            eventCard.append("text")
                .attr("x", 65)
                .attr("y", 8)
                .attr("text-anchor", "middle")
                .attr("fill", "var(--text-muted)")
                .style("font-size", "9px")
                .text(event.duration);
        } else {
            // Final marker
            const finalMarker = eventGroup.append("g")
                .attr("transform", `translate(${width/2}, 0)`);

            finalMarker.append("circle")
                .attr("r", 30)
                .attr("fill", "#6366f1")
                .attr("opacity", 0.1);

            finalMarker.append("circle")
                .attr("r", 22)
                .attr("fill", "#6366f1")
                .style("filter", "drop-shadow(0 3px 10px rgba(99,102,241,0.5))");

            finalMarker.append("text")
                .attr("text-anchor", "middle")
                .attr("y", -12)
                .attr("fill", "#fff")
                .style("font-size", "16px")
                .text("‚úì");

            finalMarker.append("text")
                .attr("text-anchor", "middle")
                .attr("y", 5)
                .attr("fill", "#fff")
                .style("font-size", "10px")
                .style("font-weight", "700")
                .text("READY");
        }

        // Connection dots for participating lanes
        event.lanes.forEach(laneId => {
            const laneIndex = timelineData.swimlanes.findIndex(l => l.id === laneId);
            if (laneIndex === -1) return;

            const lane = timelineData.swimlanes[laneIndex];
            const laneX = laneIndex * swimlaneWidth + swimlaneWidth/2;

            g.append("circle")
                .attr("cx", laneX)
                .attr("cy", y)
                .attr("r", 6)
                .attr("fill", lane.color)
                .attr("stroke", "#fff")
                .attr("stroke-width", 2)
                .style("filter", "drop-shadow(0 2px 4px rgba(0,0,0,0.2))")
                .style("cursor", "pointer")
                .on("mouseenter", function() {
                    d3.select(this)
                        .transition().duration(200)
                        .attr("r", 8);
                })
                .on("mouseleave", function() {
                    d3.select(this)
                        .transition().duration(200)
                        .attr("r", 6);
                });
        });
    });
}

// Collapsible categories
document.querySelectorAll('.category-header').forEach(header => {
    header.addEventListener('click', function() {
        const content = this.nextElementSibling;
        const toggle = this.querySelector('.category-toggle');
        const isOpen = content.style.maxHeight;

        if (isOpen) {
            content.style.maxHeight = null;
            toggle.textContent = '+';
        } else {
            content.style.maxHeight = content.scrollHeight + 'px';
            toggle.textContent = '‚àí';
        }
    });
});

window.addEventListener('load', () => {
    createTimeline();
    document.querySelector('.category-header').click();
});

window.addEventListener('resize', createTimeline);

loadHeaderFooter("../../../automation/header.html", "../../../automation/footer.html");
</script>

</body>
</html>
